<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <link rel="stylesheet" href="css/leaflet.css">
        <link rel="stylesheet" href="css/L.Control.Layers.Tree.css">
        <link rel="stylesheet" href="css/qgis2web.css">
        <link rel="stylesheet" href="css/fontawesome-all.min.css">
        <style>
        #map {
            width: 1200px;
            height: 850px;
        }
        </style>
        <title>Petroleum Impact in Western KY</title>
    </head>
    <body>
        <div id="map">
        </div>
        <script src="js/qgis2web_expressions.js"></script>
        <script src="js/leaflet.js"></script>
        <script src="js/L.Control.Layers.Tree.min.js"></script>
        <script src="js/leaflet.rotatedMarker.js"></script>
        <script src="js/leaflet.pattern.js"></script>
        <script src="js/leaflet-hash.js"></script>
        <script src="js/Autolinker.min.js"></script>
        <script src="js/rbush.min.js"></script>
        <script src="js/labelgun.min.js"></script>
        <script src="js/labels.js"></script>
        <script src="data/PluggedWells_1.js"></script>
        <script src="data/UnpluggedWells_2.js"></script>
        <script>
        var map = L.map('map', {
            zoomControl:true, maxZoom:28, minZoom:1
        }).fitBounds([[36.102980502948355,-88.919556180043],[38.19876104770589,-84.8459081939535]]);
        var hash = new L.Hash(map);
        map.attributionControl.setPrefix('<a href="https://github.com/tomchadwin/qgis2web" target="_blank">qgis2web</a> &middot; <a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a> &middot; <a href="https://qgis.org">QGIS</a>');
        var autolinker = new Autolinker({truncate: {length: 30, location: 'smart'}});
        function removeEmptyRowsFromPopupContent(content, feature) {
         var tempDiv = document.createElement('div');
         tempDiv.innerHTML = content;
         var rows = tempDiv.querySelectorAll('tr');
         for (var i = 0; i < rows.length; i++) {
             var td = rows[i].querySelector('td.visible-with-data');
             var key = td ? td.id : '';
             if (td && td.classList.contains('visible-with-data') && feature.properties[key] == null) {
                 rows[i].parentNode.removeChild(rows[i]);
             }
         }
         return tempDiv.innerHTML;
        }
        document.querySelector(".leaflet-popup-pane").addEventListener("load", function(event) {
          var tagName = event.target.tagName,
            popup = map._popup;
          // Also check if flag is already set.
          if (tagName === "IMG" && popup && !popup._updated) {
            popup._updated = true; // Set flag to prevent looping.
            popup.update();
          }
        }, true);
        var bounds_group = new L.featureGroup([]);
        function setBounds() {
        }
        map.createPane('pane_basemap_0');
        map.getPane('pane_basemap_0').style.zIndex = 400;
        var layer_basemap_0 = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
            pane: 'pane_basemap_0',
            opacity: 1.0,
            attribution: '',
            minZoom: 1,
            maxZoom: 28,
            minNativeZoom: 0,
            maxNativeZoom: 18
        });
        layer_basemap_0;
        map.addLayer(layer_basemap_0);
        function pop_PluggedWells_1(feature, layer) {
            var popupContent = '<table>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['NUMPOINTS'] !== null ? autolinker.link(feature.properties['NUMPOINTS'].toLocaleString()) : '') + '</td>\
                    </tr>\
                </table>';
            layer.bindPopup(popupContent, {maxHeight: 400});
            var popup = layer.getPopup();
            var content = popup.getContent();
            var updatedContent = removeEmptyRowsFromPopupContent(content, feature);
            popup.setContent(updatedContent);
        }

        function style_PluggedWells_1_0(feature) {
            if (feature.properties['NUMPOINTS'] >= 0.000000 && feature.properties['NUMPOINTS'] <= 4.000000 ) {
                return {
                pane: 'pane_PluggedWells_1',
                opacity: 1,
                color: 'rgba(35,35,35,0.5)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(247,251,255,0.5)',
                interactive: true,
            }
            }
            if (feature.properties['NUMPOINTS'] >= 4.000000 && feature.properties['NUMPOINTS'] <= 13.000000 ) {
                return {
                pane: 'pane_PluggedWells_1',
                opacity: 1,
                color: 'rgba(35,35,35,0.5)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(200,220,240,0.5)',
                interactive: true,
            }
            }
            if (feature.properties['NUMPOINTS'] >= 13.000000 && feature.properties['NUMPOINTS'] <= 38.000000 ) {
                return {
                pane: 'pane_PluggedWells_1',
                opacity: 1,
                color: 'rgba(35,35,35,0.5)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(115,178,216,0.5)',
                interactive: true,
            }
            }
            if (feature.properties['NUMPOINTS'] >= 38.000000 && feature.properties['NUMPOINTS'] <= 91.800000 ) {
                return {
                pane: 'pane_PluggedWells_1',
                opacity: 1,
                color: 'rgba(35,35,35,0.5)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(41,121,185,0.5)',
                interactive: true,
            }
            }
            if (feature.properties['NUMPOINTS'] >= 91.800000 && feature.properties['NUMPOINTS'] <= 579.000000 ) {
                return {
                pane: 'pane_PluggedWells_1',
                opacity: 1,
                color: 'rgba(35,35,35,0.5)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(8,48,107,0.5)',
                interactive: true,
            }
            }
        }
        map.createPane('pane_PluggedWells_1');
        map.getPane('pane_PluggedWells_1').style.zIndex = 401;
        map.getPane('pane_PluggedWells_1').style['mix-blend-mode'] = 'normal';
        var layer_PluggedWells_1 = new L.geoJson(json_PluggedWells_1, {
            attribution: '',
            interactive: true,
            dataVar: 'json_PluggedWells_1',
            layerName: 'layer_PluggedWells_1',
            pane: 'pane_PluggedWells_1',
            onEachFeature: pop_PluggedWells_1,
            style: style_PluggedWells_1_0,
        });
        bounds_group.addLayer(layer_PluggedWells_1);
        map.addLayer(layer_PluggedWells_1);
        function pop_UnpluggedWells_2(feature, layer) {
            var popupContent = '<table>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['NUMPOINTS'] !== null ? autolinker.link(feature.properties['NUMPOINTS'].toLocaleString()) : '') + '</td>\
                    </tr>\
                </table>';
            layer.bindPopup(popupContent, {maxHeight: 400});
            var popup = layer.getPopup();
            var content = popup.getContent();
            var updatedContent = removeEmptyRowsFromPopupContent(content, feature);
            popup.setContent(updatedContent);
        }

        function style_UnpluggedWells_2_0(feature) {
            if (feature.properties['NUMPOINTS'] >= 0.000000 && feature.properties['NUMPOINTS'] <= 1.000000 ) {
                return {
                pane: 'pane_UnpluggedWells_2',
                opacity: 1,
                color: 'rgba(35,35,35,0.5)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(255,245,235,0.5)',
                interactive: true,
            }
            }
            if (feature.properties['NUMPOINTS'] >= 1.000000 && feature.properties['NUMPOINTS'] <= 6.000000 ) {
                return {
                pane: 'pane_UnpluggedWells_2',
                opacity: 1,
                color: 'rgba(35,35,35,0.5)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(253,210,165,0.5)',
                interactive: true,
            }
            }
            if (feature.properties['NUMPOINTS'] >= 6.000000 && feature.properties['NUMPOINTS'] <= 18.000000 ) {
                return {
                pane: 'pane_UnpluggedWells_2',
                opacity: 1,
                color: 'rgba(35,35,35,0.5)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(253,146,67,0.5)',
                interactive: true,
            }
            }
            if (feature.properties['NUMPOINTS'] >= 18.000000 && feature.properties['NUMPOINTS'] <= 51.000000 ) {
                return {
                pane: 'pane_UnpluggedWells_2',
                opacity: 1,
                color: 'rgba(35,35,35,0.5)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(223,80,5,0.5)',
                interactive: true,
            }
            }
            if (feature.properties['NUMPOINTS'] >= 51.000000 && feature.properties['NUMPOINTS'] <= 363.000000 ) {
                return {
                pane: 'pane_UnpluggedWells_2',
                opacity: 1,
                color: 'rgba(35,35,35,0.5)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(127,39,4,0.5)',
                interactive: true,
            }
            }
        }
        map.createPane('pane_UnpluggedWells_2');
        map.getPane('pane_UnpluggedWells_2').style.zIndex = 402;
        map.getPane('pane_UnpluggedWells_2').style['mix-blend-mode'] = 'normal';
        var layer_UnpluggedWells_2 = new L.geoJson(json_UnpluggedWells_2, {
            attribution: '',
            interactive: true,
            dataVar: 'json_UnpluggedWells_2',
            layerName: 'layer_UnpluggedWells_2',
            pane: 'pane_UnpluggedWells_2',
            onEachFeature: pop_UnpluggedWells_2,
            style: style_UnpluggedWells_2_0,
        });
        bounds_group.addLayer(layer_UnpluggedWells_2);
        map.addLayer(layer_UnpluggedWells_2);
            var title = new L.Control();
            title.onAdd = function (map) {
                this._div = L.DomUtil.create('div', 'info');
                this.update();
                return this._div;
            };
            title.update = function () {
                this._div.innerHTML = '<h2>Petroleum Impact in Western KY</h2>';
            };
            title.addTo(map);
            var abstract = new L.Control({'position':'topleft'});
            abstract.onAdd = function (map) {
                this._div = L.DomUtil.create('div',
                'leaflet-control abstract');
                this._div.id = 'abstract'
                    this._div.setAttribute("onmouseenter", "abstract.show()");
                    this._div.setAttribute("onmouseleave", "abstract.hide()");
                    this.hide();
                    return this._div;
                };
                abstract.hide = function () {
                    this._div.classList.remove("abstractUncollapsed");
                    this._div.classList.add("abstract");
                    this._div.innerHTML = 'i'
                }
                abstract.show = function () {
                    this._div.classList.remove("abstract");
                    this._div.classList.add("abstractUncollapsed");
                    this._div.innerHTML = 'This map shows petroleum wells within the Western KY Coalfield region of Kentucky in two groups: plugged and unplugged. Unplugged petroleum wells pose the greatest risk for environmental and ecological damage, so the aim of this map is to highlight those areas that may be most affected by unreclaimed wells. Data obtained from the Kentucky Geological Survey (KGS). Map produced by Lucas Ruckdeschel for GEO 405 Advanced Cartography at the University of Kentucky.';
            };
            abstract.addTo(map);
        var baseMaps = {};
        var overlaysTree = [
            {label: 'Unplugged Wells<br /><table><tr><td style="text-align: center;"><img src="legend/UnpluggedWells_2_010.png" /></td><td>0 - 1</td></tr><tr><td style="text-align: center;"><img src="legend/UnpluggedWells_2_161.png" /></td><td>1 - 6</td></tr><tr><td style="text-align: center;"><img src="legend/UnpluggedWells_2_6182.png" /></td><td>6 - 18</td></tr><tr><td style="text-align: center;"><img src="legend/UnpluggedWells_2_18513.png" /></td><td>18 - 51</td></tr><tr><td style="text-align: center;"><img src="legend/UnpluggedWells_2_513634.png" /></td><td>51 - 363</td></tr></table>', layer: layer_UnpluggedWells_2},
            {label: 'Plugged Wells<br /><table><tr><td style="text-align: center;"><img src="legend/PluggedWells_1_040.png" /></td><td>0 - 4</td></tr><tr><td style="text-align: center;"><img src="legend/PluggedWells_1_4131.png" /></td><td>4 - 13</td></tr><tr><td style="text-align: center;"><img src="legend/PluggedWells_1_13382.png" /></td><td>13 - 38</td></tr><tr><td style="text-align: center;"><img src="legend/PluggedWells_1_38923.png" /></td><td>38 - 92</td></tr><tr><td style="text-align: center;"><img src="legend/PluggedWells_1_925794.png" /></td><td>92 - 579</td></tr></table>', layer: layer_PluggedWells_1},
            {label: "basemap", layer: layer_basemap_0},]
        var lay = L.control.layers.tree(null, overlaysTree,{
            //namedToggle: true,
            //selectorBack: false,
            //closedSymbol: '&#8862; &#x1f5c0;',
            //openedSymbol: '&#8863; &#x1f5c1;',
            //collapseAll: 'Collapse all',
            //expandAll: 'Expand all',
            collapsed: false, 
        });
        lay.addTo(map);
        setBounds();
        </script>
    </body>
</html>
